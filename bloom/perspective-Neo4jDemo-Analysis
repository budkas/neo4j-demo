{"categories":[{"id":1,"name":"AccHolder","labels":["AccHolder"],"properties":[{"name":"cif","exclude":false,"dataType":"bigint"},{"name":"name","exclude":false,"dataType":"string"},{"name":"age","exclude":false,"dataType":"bigint"},{"name":"email","exclude":false,"dataType":"string"},{"name":"country","exclude":false,"dataType":"string"},{"name":"gender","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#FFE081","size":1,"icon":"DB188874-D25F-4B34-A296-E5E950072319","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"]},{"id":2,"name":"BankAccount","labels":["BankAccount"],"properties":[{"name":"accNum","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#C990C0","size":1,"icon":"54C4B764-2D83-4F59-9178-24229A6965BF","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_BankAccount"]},{"id":3,"name":"Phone","labels":["Phone"],"properties":[{"name":"number","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#F79767","size":1,"icon":"6D4B9047-8A4D-432F-B774-E7B8F8AA5FA8","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_Phone"]},{"id":4,"name":"Job","labels":["Job"],"properties":[{"name":"title","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#57C7E3","size":1,"icon":"B400D1F7-0D84-4303-A9AA-4A6A352439B8","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_Job"]},{"id":5,"name":"Country","labels":["Country"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"code","exclude":false,"dataType":"string"},{"name":"region","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1667815309846,"color":"#F16667","size":1,"icon":"5F4FEEB8-CEC0-497E-A2EF-D9C15AE7B321","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"]},{"id":6,"name":"Address","labels":["Address"],"properties":[{"name":"street","exclude":false,"dataType":"string"},{"name":"zip","exclude":false,"dataType":"bigint"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#D9C8AE","size":1,"icon":"59435072-6EE1-4BB0-869A-50F2FB447DEB","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_Address"]},{"id":7,"name":"BankTransfer","labels":["BankTransfer"],"properties":[{"name":"amount","exclude":false,"dataType":"number"},{"name":"transferTime","exclude":false,"dataType":"Time"},{"name":"transferDate","exclude":false,"dataType":"Date"},{"name":"transactionId","exclude":false,"dataType":"bigint"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#8DCC93","size":1,"icon":"AE788B64-114D-4032-832D-0DECC5CB902D","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_BankTransfer"]},{"id":8,"name":"CreditCard","labels":["CreditCard"],"properties":[{"name":"cardNum","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#ECB5C9","size":1,"icon":"5E76130D-D6FD-4FD4-9736-36B92271225D","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_CreditCard"]},{"id":9,"name":"Purchase","labels":["Purchase"],"properties":[{"name":"amount","exclude":false,"dataType":"number"},{"name":"purchaseDate","exclude":false,"dataType":"Date"},{"name":"purchaseTime","exclude":false,"dataType":"Time"},{"name":"transactionId","exclude":false,"dataType":"bigint"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#4C8EDA","size":1,"icon":"7770FBD8-A547-47FD-BE1D-C26FA6EAF03D","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","1_CATEGORY_LABEL_CAPTION_KEY_PREFIX_Purchase"]},{"id":10,"name":"Merchant","labels":["Merchant"],"properties":[{"name":"name","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#FFC454","size":1,"icon":"8B07ECC5-1A31-4C5D-B451-EDC22260E595","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"]},{"id":11,"name":"CardIssuer","labels":["CardIssuer"],"properties":[{"name":"name","exclude":false,"dataType":"string"}],"createdAt":1666579459674,"lastEditedAt":1666579459674,"color":"#DA7194","size":1,"icon":"36ADC22A-4278-4483-8CF4-5CC5F66CA25D","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"]}],"name":"Neo4jDemo-Analysis","id":"ff5b31c0-6419-11ed-8cca-f79047a9ed7b","labels":{"AccHolder":[{"propertyKey":"email","type":"AccHolder","dataType":"string"},{"propertyKey":"gender","type":"AccHolder","dataType":"string"},{"propertyKey":"name","type":"AccHolder","dataType":"string"},{"propertyKey":"country","type":"AccHolder","dataType":"string"},{"propertyKey":"cif","type":"AccHolder","dataType":"bigint"},{"propertyKey":"age","type":"AccHolder","dataType":"bigint"}],"BankAccount":[{"propertyKey":"accNum","type":"BankAccount","dataType":"string"}],"CreditCard":[{"propertyKey":"cardNum","type":"CreditCard","dataType":"string"}],"Address":[{"propertyKey":"street","type":"Address","dataType":"string"},{"propertyKey":"zip","type":"Address","dataType":"bigint"}],"Phone":[{"propertyKey":"number","type":"Phone","dataType":"string"}],"Job":[{"propertyKey":"title","type":"Job","dataType":"string"}],"Country":[{"propertyKey":"region","type":"Country","dataType":"string"},{"propertyKey":"name","type":"Country","dataType":"string"},{"propertyKey":"code","type":"Country","dataType":"string"}],"BankTransfer":[{"propertyKey":"transferTime","type":"BankTransfer","dataType":"Time"},{"propertyKey":"transactionId","type":"BankTransfer","dataType":"bigint"},{"propertyKey":"amount","type":"BankTransfer","dataType":"number"},{"propertyKey":"transferDate","type":"BankTransfer","dataType":"Date"}],"Purchase":[{"propertyKey":"purchaseTime","type":"Purchase","dataType":"Time"},{"propertyKey":"transactionId","type":"Purchase","dataType":"bigint"},{"propertyKey":"amount","type":"Purchase","dataType":"number"},{"propertyKey":"purchaseDate","type":"Purchase","dataType":"Date"}],"Merchant":[{"propertyKey":"name","type":"Merchant","dataType":"string"}],"CardIssuer":[{"propertyKey":"name","type":"CardIssuer","dataType":"string"}],"_Neodash_Dashboard":[{"propertyKey":"date","type":"_Neodash_Dashboard","dataType":"DateTime"},{"propertyKey":"user","type":"_Neodash_Dashboard","dataType":"string"},{"propertyKey":"uuid","type":"_Neodash_Dashboard","dataType":"string"},{"propertyKey":"title","type":"_Neodash_Dashboard","dataType":"string"},{"propertyKey":"version","type":"_Neodash_Dashboard","dataType":"string"},{"propertyKey":"content","type":"_Neodash_Dashboard","dataType":"string"}]},"relationshipTypes":[{"id":"HAS_ADDRESS","name":"HAS_ADDRESS","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"HAS_PHONE","name":"HAS_PHONE","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"HAS_BANKACCOUNT","name":"HAS_BANKACCOUNT","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"HAS_CREDITCARD","name":"HAS_CREDITCARD","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"WORKS_AS","name":"WORKS_AS","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"CITIZEN_OF","name":"CITIZEN_OF","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"SEND","name":"SEND","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"ISSUED_BY","name":"ISSUED_BY","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"WITH_CARD","name":"WITH_CARD","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]},{"id":"FROM","name":"FROM","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"]}],"palette":{"colors":["#FFE081","#C990C0","#F79767","#57C7E3","#F16667","#D9C8AE","#8DCC93","#ECB5C9","#4C8EDA","#FFC454","#DA7194","#569480","#848484","#D9D9D9"],"currentIndex":12},"createdAt":1668429833947,"lastEditedAt":1668429833947,"templates":[{"name":"RFM based recommendations for a selected merchant","id":"tmpl:1668348754744","createdAt":1668348754744,"text":"RFM based recommendations for $merchant","cypher":"WITH date('2021-06-30') as curDate\nWITH curDate, curDate-duration({days:30}) as curDate30\nMATCH(ah:AccHolder)-[h:HAS_CREDITCARD]->(c:CreditCard)<-[w:WITH_CARD]-(p:Purchase)-[:FROM]->(m:Merchant {name:$merchant})\nWHERE p.purchaseDate <= curDate AND p.purchaseDate >= curDate30\nWITh ah,\n    SUM(p.amount) as monetory,\n    COUNT(DISTINCT p) as frequency,\n    MIN(\n        duration.inDays(\n            p.purchaseDate, curDate\n        ).days\n    ) AS recency\nWHERE recency < 5 AND monetory > 5000 AND frequency > 2\nWITH ah\nMATCH (ah)-[:HAS_BANKACCOUNT]->(:BankAccount)-[:SEND]-(:BankTransfer)-[:SEND]-(:BankAccount)<-[:HAS_BANKACCOUNT]-(friend:AccHolder)\nWITH ah as cust, friend as friend, count(friend) as frequency\nWHERE frequency > 0\nRETURN  friend","isUpdateQuery":null,"params":[{"name":"$merchant","dataType":"String","collapsed":false,"suggestionLabel":"Merchant","suggestionProp":"name","suggestionBoolean":false,"cypher":null}],"hasCypherErrors":false},{"name":"Money Laundering through Foreign Exchange","id":"tmpl:1667815278747","createdAt":1667815278747,"text":"Money Laundering through Foreign Exchange","cypher":"MATCH(c1:Country)<-[:CITIZEN_OF]-(sender:AccHolder)-[:HAS_BANKACCOUNT]->(fromAcc:BankAccount)-[:SEND]->(trf:BankTransfer)-[:SEND]->(toAcc:BankAccount)<-[:HAS_BANKACCOUNT]-(receiver:AccHolder)-[:CITIZEN_OF]->(c2:Country)\nWHERE c1.name <> c2.name\nWITH c1, c2, sender, receiver\nMATCH (receiver)-[:HAS_BANKACCOUNT]->(:BankAccount)-[:SEND]->(:BankTransfer)-[:SEND]->(:BankAccount)<-[:HAS_BANKACCOUNT]-(newReceiver:AccHolder)-[:CITIZEN_OF]->(c1)\nWITH sender, newReceiver\nMATCH p=(sender)-[:SEND|HAS_BANKACCOUNT|WORKS_AS*2..4]-(newReceiver)\nRETURN p","isUpdateQuery":null,"params":[],"hasCypherErrors":false},{"name":"High Velocity Customers","id":"tmpl:1666595473967","createdAt":1666595473967,"text":"Money Mules","cypher":"MATCH (acc:BankAccount)-[r:SEND]-(:BankTransfer)\nWITH distinct acc, count(r) as cnt\nWHERE cnt > 23\nMATCH path=(acc)<-[:HAS_BANKACCOUNT]-(ah:AccHolder)-[rel*2..4]-(ah2:AccHolder)\nWHERE ALL(r in rel WHERE not(type(r)='CITIZEN_OF') )\nRETURN path","isUpdateQuery":null,"params":[],"hasCypherErrors":false},{"name":"High Volume (thresholds 180,000 , 200,000)","id":"tmpl:1666593872966","createdAt":1666593872966,"text":"Customers with daily volume of over $threshold","cypher":"WITH date('2021-06-30') as curDate, $threshold as curThreshold\nWITH curThreshold, curDate, curDate-duration({days:30}) as curDate30\nWITH curDate, curDate30, curThreshold\nUNWIND [days IN range(1,duration.between(curDate30,curDate).days) | \n         curDate30 + duration({days:days})] as day\nOPTIONAL MATCH (credit)-[:SEND]->(acc:BankAccount) //inward transfers\nWHERE credit.transferDate = day\nOPTIONAL MATCH (acc)-[:SEND]->(debit) //outward transfers\nWHERE debit.transferDate = day\nWITH acc, day, curThreshold, sum(credit.amount) as credits, sum(debit.amount) as debits\nWHERE credits > curThreshold OR debits > curThreshold\nMATCH path=(acc)<-[:HAS_BANKACCOUNT]-(ah:AccHolder)-[rel*2..4]-(ah2:AccHolder)\nWHERE ALL(r in rel WHERE not(type(r)='CITIZEN_OF') )\nRETURN path","isUpdateQuery":null,"params":[{"name":"$threshold","dataType":"Integer","collapsed":false,"suggestionLabel":null,"suggestionProp":null,"suggestionBoolean":false,"cypher":null}],"hasCypherErrors":false},{"name":"Remittances","id":"tmpl:1666590317092","createdAt":1666590317092,"text":"Remittances","cypher":"MATCH (c1:Country)<-[:CITIZEN_OF]-(ah1:AccHolder)-[:HAS_BANKACCOUNT]->(sender:BankAccount)-[:SEND]->\n(trf:BankTransfer)-[:SEND]->(receiver:BankAccount)<-[:HAS_BANKACCOUNT]-(ah2:AccHolder)-[:CITIZEN_OF]->(c2:Country)\n// remove local transfers\nWHERE c1.name <> c2.name\nWITH c1, c2\n,count(trf.amount) as numTransfers, sum(trf.amount) as totalTransfer\nWHERE numTransfers > 2\nMATCH p=(c1)<-[:CITIZEN_OF]-(ah1:AccHolder)-[:HAS_BANKACCOUNT]->(sender:BankAccount)-[:SEND]->\n(trf:BankTransfer)-[:SEND]->(receiver:BankAccount)<-[:HAS_BANKACCOUNT]-(ah2:AccHolder)-[:CITIZEN_OF]->(c2)\nRETURN p","isUpdateQuery":null,"params":[],"hasCypherErrors":false},{"name":"Aggregators","id":"tmpl:1666588964820","createdAt":1666588964820,"text":"Aggregators","cypher":"WITH date('2021-06-30') as curDate\nWITH curDate, curDate-duration({days:30}) as curDate30\nMATCH (ah:AccHolder)-[:HAS_BANKACCOUNT]->(recAcc:BankAccount)<-[:SEND]-(trf:BankTransfer)\nWHERE trf.transferDate >= curDate30\nAND trf.transferDate <= curDate\nWITH recAcc.accNum as accountNumber,\n\tmin(trf.transferDate) as StartDate,\n\tmax(trf.transferDate) as EndDate,\n\tduration.inDays(min(trf.transferDate),max(trf.transferDate)).days as NumDays,\n\tcount(trf.amount) as NumDeposits,\n\tsum(trf.amount) as TotalDeposits\nWHERE TotalDeposits > 10000\nWITH collect({accNum: accountNumber,\n\t\t\t\tstartDate: StartDate,\n\t\t\t\tendDate: EndDate,\n\t\t\t\tnumDays: NumDays,\n\t\t\t\tnumDeposits: NumDeposits,\n\t\t\t\ttotDeposits: TotalDeposits}) as aggregators\n\t\t\t\t\n// find all the rapid outgoing transfers of high percentage of incoming transfers\nUNWIND aggregators as curAgg\nMATCH (ba:BankAccount)-[:SEND]->(trf:BankTransfer)\nWHERE ba.accNum = curAgg.accNum\nAND trf.transferDate >= curAgg.startDate\nAND trf.transferDate <= curAgg.endDate+duration({days:10})\nWITH ba.accNum as accountNumber,\n\tcurAgg.startDate as StartDate,\n\tmax(trf.transferDate) as EndDate,\n\tduration.inDays(curAgg.startDate,max(trf.transferDate)).days as NumDays,\n\tcurAgg.numDeposits as NumDeposits,\n\tcurAgg.totDeposits as TotalDeposits,\n\tcount(trf.amount) as NumWithdrawals,\n\tsum(trf.amount) as TotalWithdrawals,\n\tabs(sum(trf.amount))/curAgg.totDeposits as pctWithdrawal\nWHERE pctWithdrawal > 0.75 AND pctWithdrawal <= 1.0\n\nMATCH p = (ah:AccHolder)-[:HAS_BANKACCOUNT]->(ba:BankAccount)-[:SEND]->(:BankTransfer)-[:SEND]->(:BankAccount)\nWHERE ba.accNum = accountNumber\nRETURN p","isUpdateQuery":null,"params":[],"hasCypherErrors":false},{"name":"RFM","id":"tmpl:1666584648402","createdAt":1666584648402,"text":"RFM for last $days days","cypher":"WITH date('2021-06-30') as curDate\nWITH curDate, curDate-duration({days:$days}) as curDate30\nMATCH(ah:AccHolder)-[h:HAS_CREDITCARD]->(c:CreditCard)<-[w:WITH_CARD]-(p:Purchase)-[:FROM]->(m:Merchant)\nWHERE p.purchaseDate <= curDate AND p.purchaseDate >= curDate30\nWITh ah,\n    m,\n    SUM(p.amount) as monetory,\n    COUNT(DISTINCT p) as frequency,\n    MIN(\n        duration.inDays(\n            p.purchaseDate, curDate\n        ).days\n    ) AS recency\nWHERE recency < 5 AND monetory > 5000 AND frequency > 2\nWITH ah,m\nMATCH p=(ah)-[:HAS_CREDITCARD]->(:CreditCard)<-[:WITH_CARD]-(:Purchase)-[:FROM]->(m)\nRETURN p","isUpdateQuery":null,"params":[{"name":"$days","dataType":"Integer","collapsed":false,"suggestionLabel":null,"suggestionProp":null,"suggestionBoolean":false,"cypher":null}],"hasCypherErrors":false},{"name":"Search phrase","id":"tmpl:1666584008209","createdAt":1666584008209,"text":"Layering","cypher":"WITH date('2021-06-30') as curDate\nWITH curDate, curDate-duration({days:30}) as curDate30\nMATCH p=(ah1:AccHolder)-[:HAS_BANKACCOUNT]->(ba1:BankAccount)-[:SEND]->(trf1:BankTransfer)-[:SEND]->(ba2:BankAccount)-[:SEND]->(trf2:BankTransfer)-[:SEND]->(ba3:BankAccount)<-[:HAS_BANKACCOUNT]-(ah2:AccHolder)\nWHERE trf1.transferDate <= curDate\n    AND trf1.transferDate >= curDate30\n    AND trf2.transferDate >= trf1.transferDate\n    AND duration.inDays(trf1.transferDate, trf2.transferDate).days <=7\n    AND trf2.amount > trf1.amount * 0.75\n    AND trf2.amount < trf1.amount\n    AND trf1.amount > 1000\nRETURN p","isUpdateQuery":null,"params":[],"hasCypherErrors":false}],"sceneActions":[],"hiddenRelationshipTypes":[],"hiddenCategories":[],"hideUncategorisedData":false,"isAuto":true,"parentPerspectiveId":"cb64b5c0-634d-11ed-84b8-6fcddfd7fb68","metadata":{"pathSegments":[{"source":"Purchase","relationshipType":"WITH_CARD","target":"CreditCard"},{"source":"AccHolder","relationshipType":"HAS_CREDITCARD","target":"CreditCard"},{"source":"AccHolder","relationshipType":"HAS_ADDRESS","target":"Address"},{"source":"AccHolder","relationshipType":"CITIZEN_OF","target":"Country"},{"source":"AccHolder","relationshipType":"HAS_BANKACCOUNT","target":"BankAccount"},{"source":"AccHolder","relationshipType":"WORKS_AS","target":"Job"},{"source":"Purchase","relationshipType":"ISSUED_BY","target":"CardIssuer"},{"source":"Purchase","relationshipType":"FROM","target":"Merchant"},{"source":"BankTransfer","relationshipType":"SEND","target":"BankAccount"},{"source":"BankTransfer","relationshipType":"SEND","target":"BankTransfer"},{"source":"BankAccount","relationshipType":"SEND","target":"BankTransfer"},{"source":"BankAccount","relationshipType":"SEND","target":"BankAccount"},{"source":"AccHolder","relationshipType":"HAS_PHONE","target":"Phone"}],"indexes":[{"label":"AccHolder","type":"native","propertyKeys":["cif","email","gender","name","country","age"]},{"label":"BankAccount","type":"native","propertyKeys":["accNum"]},{"label":"BankTransfer","type":"native","propertyKeys":["transactionId"]},{"label":"CardIssuer","type":"native","propertyKeys":["name"]},{"label":"Country","type":"native","propertyKeys":["name","region","code"]},{"label":"CreditCard","type":"native","propertyKeys":["cardNum"]},{"label":"Job","type":"native","propertyKeys":["title"]},{"label":"Merchant","type":"native","propertyKeys":["name"]},{"label":"Phone","type":"native","propertyKeys":["number"]},{"label":"Purchase","type":"native","propertyKeys":["transactionId"]},{"label":null,"type":"native","propertyKeys":[]},{"label":"Address","type":"native","isMetadataPropIndex":true,"propertyKeys":["street","zip"]},{"label":"_Neodash_Dashboard","type":"native","isMetadataPropIndex":true,"propertyKeys":["date","user","uuid","title","version","content"]}],"stats":{"labels":{},"relationshipTypes":{"HAS_ADDRESS":101,"HAS_PHONE":101,"HAS_BANKACCOUNT":101,"HAS_CREDITCARD":101,"WORKS_AS":101,"CITIZEN_OF":101,"SEND":2002,"ISSUED_BY":9958,"WITH_CARD":9958,"FROM":9958}}},"version":"2.5.1"}